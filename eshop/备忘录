没有做的:

     cookie的过期时间没有设定
     用户中心的三个页面的显示问题  高亮显示
     用户收货管理的展现和隐藏
     (解决)设定默认值后 跟新用户表中的信息  然后咱现在前端

问题:
    可以实现邮箱登陆 但是怎么实现使用电话号码登陆呢??

    什么加上了个 / 就带表的是 从根目录跳转 不加就道代表的是从当前目录进行重定向
        /user/login/  这个是在从根目录下跳转
        user/login/  这个是从当前的目录去跳转
       render 的时候 使用的是  user/login.html  这个代表的是在当前的目录去找的基础上去找这个文档

    要知道每个木块和类库是干嘛用的


    关于用户认证系统的使用  在后台登陆的时候怎么去获取session中的在,
    前端登陆的时候 可以自己去设定session的键,获取到没有问题 但是在后台登陆的时候 怎么去获取呢session中的信息
    这个认证系统存储的session的key是什么??


 疑问: 使用locals()函数 返回前端的信息 和直接采用 字典的形式返回的哪个效率好些 哪个是常用的

解决: 使用locals 函数 会自动构建一个上下文 会把当前视图函数中的变量全部返回 用不到的也会进行返回 使用字典
        的形式就是 只返回自己需要的  (返回了 不使用 不进行解析  有没有什么性能影响)

 问题:  内置的认证系统的流程  以及这个session的管理
        怎么实现点击编辑的时候 把值放回到莫泰对话框中

    too many values to unpack(except 2)
解答:
    遇到这个问题是因为在 使用get的时候 没有去指定get(email=email)参数的属性值
	    直接使用了get(email) 导致出错



经验总结:

    在设定邮箱注册的时候 要限制邮箱是唯一的 不能重复

    在数据库中 存储电话号码的时候不能执行整型的  只能使用 字符串形式的 因为整型长度是有限的

    在数据库执行删除操作的时候 是没有返回值的 删除一条数据 返回的是一个None

    在使用get获取的时候 没有的话 抛出异常  多个的话也抛出异常

    使用数据库的时候 使用filter 过滤没有的话 返回的是一个空的查询集

    在通过一个一类去给多类添加对象的时候 先要获取一个类的对象 然后把这个一类的对象添加到这儿多类中
        形成了 关联的操作  然后就可以给对象添加其他的属性了

    用户在编辑和修改自己的信息的时候 使用一个视图函数去执行的思路:
        在url中构造参数 在后台接收参数 根据参数去执行不同的操作 就去执行对应的函数

第一天 7-5:
     前端完成:

        用户模块的模板的抽取
        登陆 注册模块的模板的抽取

     未完成:

        登陆页面的js 前端没有

        暂留问题没有解决:
            后台返回的 err 错误 没有效果  自己设置的css 样式没有起作用

            在注册页面的时候 发送的ajax 请求 不能发送  程序 不能进入\(已经解决  get方法调用出错)

      问题: 在用户中心进行页面 跳转的时候 出现页面url的叠加  之前的是 在进行重重定向的时候 出现 是忘了加上/ 代表的是跟目录
            这次问题在哪里???? (我操 看错地方了 fuck)

     后台完成模块:

        用户的注册 验证 (暂缺发送邮箱进行验证模块的书写)

            前端: 使用jquery和正则表达式来验证注册的信息

            后台: 配置模板文件-->静态文件-->mysql数据库-->各种settings-->创建userapp-->创建user模型
                -->数据库迁移-->加入admin-->抽取模板-->编写视图函数--> 从数据库去数据进行页面的渲染
            主要知识点:
                  继承django的用户管理类 AbstractUser(需在settings中进行配置) 使用自定义的模块来管理用户信息
                 使用form表单来验证前端提交来的信息,
                 综合的使用 render redriect jsonresponse 来处理前端发起的ajax请求
                 使用类和对象的形式继承 from django.views.generic import View来代替一个个单一的函数
                 当用户的信息提交在后台验证出错的时候 使用 login_form.username.value 来获取提交来的值 然后进行回显

         解决问题:解决了继承AbstractUser 模块不能是用户的注册密码加密的问题(解决方法详见笔记)
                 解决了使用choice的时候类型出错(需要注意choice中的参数 要和定义的模型的参数类型一致的)

         新增知识点: 1 使用了django的内置加密和解密函数  make_password 和 check_password
                    2 在前端可以单独的获取到form表单中的出错的信息 {{login_form.errors.username.0 }} 获取表单验证
                        中字段声明的的第一个错误信息
                    3 使用静态文件上下文环境/和媒体文件上下文环境 从而在前端构建动态的路径



            优化点:(优化阶段放在项目整体框架搭建完成后) 删除前端繁琐的if else 判断语句 采用自定义模板标签的形式来完成功能



        用户的登陆验证

            后台: 使用form表单来验证前端提交来的信息, 使用django的用户验证 authentica 函数来完成 用户的验证
                  通过判断用户的状态user.is_active来调用 login 函数 完成用户的登陆 把用户的信息登陆到seesion中


        用户中心模块: 当用户来修改信息的时候 需要先获取到用的的id 这样当用户在修改信息的时候才能知道是在修改谁的
                    处理用户中心的时候  需要在登陆成功的时候 记住用户的唯一id 这个id是唯一的 能辨别用户在数据库中的信息
                    在用户中心通过这个id的值 取出来 用户的信息 然后返回给前端渲染


明天计划:
    完成邮箱发送 验证功能  书写 验证和忘记密码模块  发送成功模板
     完成用户中心的视图的渲染  建立 用户发货模型 构建 莫泰对话框 可以便于添加 用户的信息 可以让用户更爱自己的信息
     完成

     登陆验证思路:
        在用户登陆成功后把用户的信息存入到session中 在装饰器中去验证这session  没有就不能录
    退出
    商品的首页
    商品的列表页
    商品额详情页

7-6 完成:
    使用邮箱发送验证码: 配置发送邮箱的设置 书写 发送邮箱的 工具类
    邮箱验证模块:注册后使用邮箱进行验证  验证不通过不能登陆
    忘记密码模块:使用邮箱验证完成密码的重置功能
    邮箱验证没有问题:
    完成使用邮箱认证登陆系统
    用户中心切换:动态显示对应的高亮
    修改:用户地址管理页面 用户可以动态的管理自己的收获地址 : 使用莫泰对话框  加上 bootstrap 布局
    完成用户管理自己的收获地址的删除操作(删除成功后是返回的是None  真不友好)
    退出完成: 调用的django内部的logout 函数  登陆就使用的login函数

    简单的装饰器完成 但是还有待修改 加强


    遇到的问题:
        1
        在模板中 不能使用 模板函数中嵌套模板变量  这样就解析不出来  不能实现动态的判断是哪个界面了
         {#        <li><a href="{% url 'user:user_center_site' %}?url_id=3" {% if  "{{ url_id }}" == 3 %} class="active" {% endif %}>· 收货地址</a></li>#}

解答: 在方法块中  直接进行使用就可以 不用在加上两个大括号了



        2
        UserProfile matching query does not exist.
        退出后 就没有session 信息了
        从后台登陆的用户  前边在去获取session 就不能获取到了  从后登陆 然后去获取session的时候 不能获取的
            使用的是django的认证系统

         即便是从后台推出了 但是我的seesion  还是在的啊  也没有设置session过期 没有进行登陆校验 怎么回事????

        这里需要做验证 当用户退出的时候  就不能在不个人中心了 直接跳转到登陆页面 或者 首页  这样就不会出现 用户的
            queryset 不能获取到问题了
    3
     使用 内置的认证系统怎么判断 当前用户是否已经登陆


     这个改怎么使用
     编辑你的项目的settings.py文件，添加如下代码：

    from django.core.urlresolvers import reverse_lazy
    LOGIN_REDIRECT_URL = reverse_lazy('dashboard')
    LOGIN_URL = reverse_lazy('login')
    LOGOUT_URL = reverse_lazy('logout')
    这些设置的意义：

    LOGIN_REDIRECT_URL：告诉Django用户登录成功后如果contrib.auth.views.login视图（view）没有获取到next参数将会默认重定向到哪个URL。
    LOGIN_URL：重定向用户登录的URL（例如：使用login_required装饰器（decorator））。
    LOGOUT_URL：重定向用户登出的URL。

    4 编辑的时候 把用户的id的值展现在get 提交 安全??

解答: 构造url  不要显示的把你的id地址暴露在地址栏中  构造url的好处的就是 不能分辨你这个数字代表的是什么意思

    5 实现:设置客户的默认的收获地址的思路:
        需要解决的问题是: 怎么在弹出莫泰对话框的时候吧用户的信息给进行回显操作

解答:

        默认的收获地址放在客户的userprofiles 中 其他的收获地址 放在收获地址的model中 当点击设置为默认的守护地址时候
        发送一个ajax请求 把 userprofiles中的默认收获地址给替换掉

    6
    真对编辑和删除操作 的思路:
     把获取操作的这条信息的id 传递给后台 后台根据id值来进行判断 具体的是操作哪个数据 需不需要先去获取zhege
        信息所属的用户???

解答:  一定是需要的  这样才能确定你是要修改的是那个用户的操作 (把信息在数据库中对应的id的传递给后台  这个id是唯一的
这样就只能找到一个不会造成多删除的操作) (首先要去获取当前的用户 然后通过用户去找下面关联的所有对象 然后再根据id值来进行
有真对的删除)

经验小结:在通过一个一类去给多类添加对象的时候 先要获取一个类的对象 然后把这个一类的对象添加到这儿多类中
        形成了 关联的操作  然后就可以给对象添加其他的属性了

     用户在编辑和修改自己的信息的时候 使用一个视图函数去执行的思路:
        在url中构造参数 在后台接收参数 根据参数去执行不同的操作 就去执行对应的函数

     7
     使用method_de  怎么给类进行装饰 使用装饰器
     @method_decorator(check_auth)
     from django.contrib.auth.decorators import login_required
     from django.utils.decorators import method_decorator





7-7 号
    一定要话流程图  一定
     7-6号未完成的 :
        点击修改默认收获地址 到添加到最是上面去
        点击编辑 弹出莫泰对话框 回显用户的信息
        构造url  实现 一个视图函数 同时能处理 编辑和删除操作
        把get提交的url 换成构造新的url地址
         把下面的一堆收货信息 进行隐藏
         扩张用户列表中的功能  使用 bootstrap 实现
         看单选框都有什么操作
         实现全选 反选  全部删除 等操作

     明天计划完成的:
        修改水果列表  实现 组合搜素
            看 算法推荐  和视图 图片 缓存的功能
             用户认证系统的全面理解
             form类的使用


     $("input:radio[name='dialCheckResult']").change(function (){ //拨通
    alert(“123”);
    });


使用  $this的话 是选中的是 父级元素 下面的所有radio 对象  父下面的所有子对象 这样才有 $this 操作

7-7
    问题:
        没有新品推荐模块 按照添加的时间 来做新品推荐  (或者使用推荐算法来完成商品的推荐)
        没有用户评论 模块 需要自己实现
         对静态文件和媒体文件的处理  是不是都凡在static的下面呢??
         media_root  static_root
         问题: 怎么在构造了 url的时候还能取通过中间件来进行过滤  这个就需要在构建列表的时候 采用的是 列表中 保存的是不需要进行记录的的url了
            不能去记录需要保存的url了 这样才能取出 构建了包含数字的url了

尝试解答:

         使用values()  和values_list() 来对数据库的查询实现优化


         如果去找静态的文件的时候  找到的时候 直接进行返回
         每找到的话 就会去走服务器流程  就把视图执行之前再去
         记录这个url  可以使用正则去匹配一下这个url
         都成功匹配到的url的时候 才会走到视图处理
         生产部署的时候  静态文件就会直接走到静态文件处理的服务器了
         就不再走自己的服务器了

完成:
    验证用户登陆的装饰器,给需要进行登陆后才能去操作的页面进行装饰:
        实现流程:用户登陆的时候  把用户的id 和 用户名 信息写入的啊session中 在前端的模板中 通过
            使用request.session.id 来判断用户是否已经登陆 使用 request.session.user 来获取用户名
    用户注销登陆的操作:
        实现的流程:当用户点击注销的时候  就把用户存在session中的信息 进行删除  使用的是 request.session.flush
              flush() 方法会删除掉用户在session中的所有的信息  clear() 方法会清空掉session中的值 但是session_key
                还是存在的  查看django的logout()  也是使用的是 flush
    实现中间件来完成用户在哪个页面点击的登陆.登陆成功后 就跳转回那个页面"
        实现的流程:这个流程需要在请求url 之后 在视图函数之前  采用中间件来完成 使用的是 process_request
            方法 重写了 请求的对象  在请求后采用 request.path 来获取 url 并和需要跳转的url 列表进行对比判断
             存在的时候 才会去 保存在session中 (保存在session中 是因为这个时候还没有response对象(操作session需要使用
             response对象 (render 和 rediect 也是返回的response对象))),在登陆成功后通过request.session.get() 去进行
             获取到url 然后进行跳转,做好url判断 当没有url的时候 就跳转到首页


    新增知识点: 采用ajax提交去请求 获取 crsf 验证 通过属性input的name值 和name属性去获取到生成的验证码
    思考两个问题:
        什么时间应该去缓存, 数据库的全局查询应该怎么去做的 (就是如果我这个views中多个地方都要使用到
            这条查询语句) 在django中使用redis 进行缓存
    商品页面的处理:
         经验小结: 就是把查询出来的视图  放在列表中进行 当方式和样式比较多的时候 就使用列表返回到前端 便于去遍历
        完成index页面的数据的渲染 () index和详细 列表页面的跳转链接
        list页面数据的渲染
        detail 数据的渲染


7-8
    利用中间件去做登陆拦截
    关于实现购物车的思路:
        把用户点击购物的商品添加到购物车后 在写入到cookie中  cookie中维护一个列表
            列表中 存放的是 用户购买的商品的对象  然后通过对象最后去获取对象中的信息
            购物车中 具体的实现 应该是在前端来实现的吧
             购物车中如果加到后太的cookie中 或者是表中




准备新增功能:
    记录用户访问的商品 然后在用户中心   根据用户 访问过的 商品类型中 选出几个点击量比较高的
        凡在广告栏中 作为推荐 用户使用

    在用户中心 可以让用户去查询 选择时间之前的购物记录
    实现用户的多级的评论
    商品的推荐
    给注册和 忘记密码加上验证码
    尝试使用第三方的验证码插件 和 分页器
    在进行邮件验证的时候需不需要给邮件的验证码进



购物车页面
    最近浏览的实现思路:
        把最近浏览的东西放入自己的cookie中  cookie中 维护的是一个列表  把浏览的商品加入到列表中

排序的实现  如果 不想多加 url中的地址 就需要使用两套的视图函数
    当默认的跳转来的时候 就需要使用不带排序的视图函数来进行解决
    当跳转来的时候 就需要跳转到 需要最全的视图函数来进行解决了
    分页和排序实现  采用的是 构建url 来进行解决  并且需要把当前选择的 排序的 依据进行返回
        把选择排序的一句 加入到分页的url中去
    (改造完毕)对排序进行改造  使用 两套视图函数进行

暂留:

    对分页进行优化  分页的异常需要进行处理  需要处理
        还剩余当只能是在当前页小于10 的时候才能出现那个省略号  这个需要改进   需要考虑到当页面比较少的时候 不能显示省略号
			需要考虑当页面大于多少的时候 才能使用



分页器的使用:


7-8 完成的功能:
    组合排序的实现  采用构造路由 不同的参数  对应不同的功能  请求成功后把对应的参数 进行返回
    简单分页的实现(实现分页 首页 末页 下一页 上一页 和单个页面的展示功能)
        在实现 末页的时候 采用了 模板变量  add:1 的写法
    反向解解析是这样写的
    url = reverse('shop:list_check', args=  (goods_category, current, ordering))

7-9:
    实现了在详细页面的点击按钮来进行购物  点击加入到购物车的时候 发送ajax请求 判断库存的数量
        当库存的数量小于购买的时候 就提醒 并阻止添加到购物车中  修改 购买的数量为最大的库存量 给出提示
        是否还需要进行购买
    具体这个ajax请求因该在什么时候 发送  在点击加减的时候  发送 肯定是不合适的  最好的就是 在点击加入到购物车的时候

    注意点:
        当在计算数量的时候 需要考虑到 输入的数量是不是个整数  需要做 isNAN来进行判断


7-10
    实现点击默认的收货的地址 默认的收货地址变成点击的（采用ａｊａｘ　数据库存储成功后　返回数据采用ｊｅｑｕｅｒｙ
    替换原有的默认收货地址）
    （暂未解决）还需要维护一个收获地址  收货人手机号码
    （暂未解决）修改为 post提交  获取到post提交的
    实现：全文检索　自定义全文检索的上下文　用户商品浏览记录　（有之前的ｃｏｏｋｉｅ实现改为ｓｅｓｓｉｏｎ实现）

    问题:
        当用户退出的时候 再去登陆的时候 这个session_key 的值就改变了 数据就改变了  session_key 为什么会
        会改变呢??（使用的是ｄｊａｎｇｏ的内部认证框架　默认的是在当点击注销按钮的时候删除了　所有的ｓｅｓｓｉｏｎ信息）


    改进 实现全文检索后 依然可以实现排序 和分页 功能  总类的检索功能



7-11
实现全文检索中的页面  排序
加入购物车  在详情页面  列表页面
计算购物车中的数量
实现购物页面的 计算 总和  实现在页面能够进行增删  全选 反选



实现：
    为应用配置ｌｏｇｇｅｒ日志功能
    使用ｒｅｄｉｓ　进行缓存（把用户的浏览记录改为有ｒｅｄｉｓ实现）
    实现购物车数据的添加　从列表也和详情页去添加购物车
    缓存购物车中商品的数量　并从ｒｅｄｉｓ中读取出来　返回前端（解決：页面从新加载的时候　购物车显示为０的情况）
    尝试使用ｒｅｄｉｓ来完成购物车功能　当用户提交订单的时候在去把数据放入到数据库中
    之前抽取的模板有问题　从新进行抽取

问题：
    日志主要记录什么内容
    判断用户用不用登录　就去加入购物车的行为　　现在的做法是基于用户是已经登录的了
    提交上来的是　购买的数量　在前段显示的需要的是　总的数量在购物车中
    当删除了数据库中的产品的时候　需要把缓存中的数量也要减去
